---
title: TiDB Cloud Built-in Monitoring
summary: Learn how to view TiDB Cloud built-in monitoring metrics and understand the meanings of these metrics.
---

# TiDB Cloud組み込みモニタリング {#tidb-cloud-built-in-monitoring}

TiDB Cloud は、クラスターの標準メトリックの完全なセットを収集して、[監視] ページに表示します。これらのメトリックを表示することで、パフォーマンスの問題を簡単に特定し、現在のデータベースの展開が要件を満たしているかどうかを判断できます。

## 監視ページをビュー {#view-the-monitoring-page}

[監視] ページでメトリックを表示するには、次の手順を実行します。

1.  [TiDB Cloudコンソール](https://tidbcloud.com/)で、プロジェクトの[**クラスター**](https://tidbcloud.com/console/clusters)ページに移動します。

    > **ヒント：**
    >
    > 複数のプロジェクトがある場合は、プロジェクト リストを表示し、左上隅の ☰ ホバー メニューから別のプロジェクトに切り替えることができます。

2.  ターゲット クラスタの名前をクリックします。クラスタの概要ページが表示されます。

3.  左側のナビゲーション ペインで**[監視]**をクリックします。

## メトリクス保持ポリシー {#metrics-retention-policy}

-   Dedicated Tierクラスターの場合、モニタリング データは 7 日間保持されます。
-   Serverless Tierクラスターの場合、モニタリング データは 3 日間保持されます。

## Dedicated Tierクラスターのモニタリング指標 {#monitoring-metrics-for-dedicated-tier-clusters}

次のセクションでは、 Dedicated Tierクラスターの [モニタリング] ページのメトリックを示します。

### 概要 {#overview}

| 指標名                     | ラベル                                  | 説明                                                                                                                                                                                                                                                                                                                                                                       |
| :---------------------- | :----------------------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| SQL タイプ別のデータベース時間       | データベース時間、{SQL タイプ}                   | データベース時間: 1 秒あたりの合計データベース時間。<br/> {SQL タイプ}: `SELECT` 、 `INSERT` 、および`UPDATE`などの SQL タイプ別に収集された、1 秒あたりの SQL ステートメントによって消費されたデータベース時間。                                                                                                                                                                                                                                    |
| 1 秒あたりのクエリ              | {SQL タイプ}                            | `SELECT` 、 `INSERT` 、 `UPDATE`などの SQL タイプ別に収集された、すべての TiDB インスタンスで 1 秒あたりに実行された SQL ステートメントの数。                                                                                                                                                                                                                                                                           |
| クエリ期間                   | avg-{SQL タイプ}、99-{SQL タイプ}           | クライアントから TiDB へのリクエストを受信してから、TiDB がリクエストを実行してクライアントに結果を返すまでの時間。通常、クライアント要求は SQL ステートメントの形式で送信されます。ただし、この期間には、 `COM_PING` 、 `COM_SLEEP` 、 `COM_STMT_FETCH` 、および`COM_SEND_LONG_DATA`などのコマンドの実行時間が含まれる場合があります。 TiDB は Multi-Query をサポートしています。これは、クライアントが`select 1; select 1; select 1;`などの複数の SQL ステートメントを一度に送信できることを意味します。この場合、このクエリの合計実行時間には、すべての SQL ステートメントの実行時間が含まれます。 |
| 失敗したクエリ                 | すべて、{エラーの種類} @ {インスタンス}              | 各 TiDB インスタンスの 1 分あたりの SQL ステートメント実行エラーに基づく、エラーの種類 (構文エラーや主キーの競合など) の統計。エラーが発生したモジュールとエラーコードが含まれています。                                                                                                                                                                                                                                                                    |
| コマンド/秒                  | クエリ、StmtExecute、および StmtPrepare      | コマンド タイプに基づいて、すべての TiDB インスタンスによって 1 秒あたりに処理されるコマンドの数。                                                                                                                                                                                                                                                                                                                   |
| Plan Cache OPS を使用したクエリ | ヒット、ミス                               | hit: すべての TiDB インスタンスでの 1 秒あたりのプラン キャッシュを使用したクエリの数。<br/> miss: すべての TiDB インスタンスで 1 秒あたりにプラン キャッシュが欠落しているクエリの数。                                                                                                                                                                                                                                                           |
| 1 秒あたりのトランザクション         | {タイプ}-{トランザクション モデル}                 | 1 秒あたりに実行されたトランザクションの数。                                                                                                                                                                                                                                                                                                                                                  |
| トランザクション期間              | avg-{トランザクション モデル}、99-{トランザクション モデル} | トランザクションの平均または 99 パーセンタイル期間。                                                                                                                                                                                                                                                                                                                                             |
| 接続数                     | すべて、アクティブな接続                         | All: すべての TiDB インスタンスへの接続数。<br/>アクティブな接続: すべての TiDB インスタンスへのアクティブな接続の数。                                                                                                                                                                                                                                                                                                  |
| 切断回数                    | {インスタンス}-{結果}                        | 各 TiDB インスタンスに切断されたクライアントの数。                                                                                                                                                                                                                                                                                                                                             |

### 高度 {#advanced}

| 指標名                       | ラベル                       | 説明                                                                                                                                              |
| :------------------------ | :------------------------ | :---------------------------------------------------------------------------------------------------------------------------------------------- |
| 平均アイドル接続時間                | avg-in-txn、avg-not-in-txn | 接続アイドル期間は、接続がアイドル状態である期間を示します。<br/> avg-in-txn: 接続がトランザクション内にある場合の平均接続アイドル時間。<br/> avg-not-in-txn: 接続がトランザクション内にない場合の平均接続アイドル時間。                |
| トークン期間を取得                 | 平均、99                     | SQL ステートメントのトークンを取得する際に消費された平均または 99 パーセンタイル期間。                                                                                                 |
| 解析期間                      | 平均、99                     | SQL ステートメントの解析で消費された平均または 99 パーセンタイル期間。                                                                                                         |
| コンパイル時間                   | 平均、99                     | 解析された SQL AST を実行計画にコンパイルする際に消費された平均または 99 パーセンタイル期間。                                                                                           |
| 実行時間                      | 平均、99                     | SQL ステートメントの実行計画の実行で消費された平均または 99 パーセンタイル期間。                                                                                                    |
| 平均 TiDB KV リクエスト期間        | {リクエストの種類}                | `Get` 、 `Prewrite` 、 `Commit`などのリクエスト タイプに基づく、すべての TiDB インスタンスでの KV リクエストの実行に費やされた平均時間。                                                         |
| 平均 TiKV gRPC 期間           | {リクエストの種類}                | `kv_get` 、 `kv_prewrite` 、 `kv_commit`などのリクエスト タイプに基づく、すべての TiKV インスタンスでの gRPC リクエストの実行に費やされた平均時間。                                              |
| 平均 / P99 PD TSO 待機/RPC 時間 | 待機-平均/99、rpc-平均/99        | 待機: すべての TiDB インスタンスで PD が TSO を返すのを待機する平均または 99 パーセンタイル期間。<br/> RPC: すべての TiDB インスタンスで TSO 要求を PD に送信してから TSO を受信するまでの平均時間または継続時間の 99 パーセンタイル。 |
| 平均 / P99 ストレージ非同期書き込み時間   | 平均、99                     | 非同期書き込みで消費された平均または 99 パーセンタイル期間。平均storage非同期書き込み時間 = 平均ストア時間 + 平均適用時間。                                                                          |
| 平均 / P99 ストア期間            | 平均、99                     | 非同期書き込み中のループの保存で消費された平均または 99 パーセンタイル期間。                                                                                                        |
| 平均 / P99 適用時間             | 平均、99                     | 非同期書き込み中にループを適用する際に消費された平均または 99 パーセンタイル期間。                                                                                                     |
| 平均 / P99 ログ追加期間           | 平均、99                     | Raftがログを追加するために消費した平均または 99 パーセンタイル期間。                                                                                                          |
| 平均 / P99 コミット ログ期間        | 平均、99                     | ログをコミットするためにRaftが消費した平均または 99 パーセンタイル期間。                                                                                                        |
| 平均 / P99 適用ログ期間           | 平均、99                     | Raftがログを適用するために消費した平均または 99 パーセンタイル期間。                                                                                                          |

### サーバ {#server}

| 指標名              | ラベル             | 説明                                       |
| :--------------- | :-------------- | :--------------------------------------- |
| TiDB アップタイム      | ノード             | 前回の再起動以降の各 TiDB ノードの実行時間。                |
| TiDB の CPU 使用率   | ノード             | 各 TiDB ノードの CPU 使用率統計。                   |
| TiDB メモリ使用量      | ノード             | 各 TiDB ノードのメモリ使用量統計。                     |
| TiKV アップタイム      | ノード             | 前回の再起動以降の各 TiKV ノードの実行時間。                |
| TiKV の CPU 使用率   | ノード             | 各 TiKV ノードの CPU 使用率統計。                   |
| TiKV メモリ使用量      | ノード             | 各 TiKV ノードのメモリ使用統計。                      |
| TiKV IO Bps      | ノード書き込み、ノード読み取り | 各 TiKV ノードでの読み取りと書き込みの 1 秒あたりの合計入出力バイト数。 |
| TiKV ストレージの使用量   | ノード             | 各 TiKV ノードのstorage使用統計。                  |
| TiFlash稼働時間      | ノード             | 前回の再起動以降の各TiFlashノードの実行時間。               |
| TiFlash のCPU 使用率 | ノード             | 各TiFlashノードの CPU 使用率統計。                  |
| TiFlashメモリ       | ノード             | 各TiFlashノードのメモリ使用統計。                     |
| TiFlash IO MBps  | ノード書き込み、ノード読み取り | 各TiFlashノードでの読み取りと書き込みの合計バイト数。           |
| TiFlashストレージの使用量 | ノード             | 各TiFlashノードのstorage使用統計。                 |

## Serverless Tierクラスターのモニタリング指標 {#monitoring-metrics-for-serverless-tier-clusters}

[監視] ページには、Serverless Tierクラスターのメトリック用の 2 つのタブがあります。

-   クラスタステータス: クラスタ レベルのメイン メトリックを表示します。
-   データベース ステータス: データベース レベルのメイン メトリックを表示します。

### クラスタステータス {#cluster-status}

次の表は、 **[クラスタステータス]**タブにあるクラスター レベルの主要なメトリックを示しています。

| 指標名             | ラベル                    | 説明                                                                                                                                                           |
| :-------------- | :--------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------- |
| リクエストユニット       | RU/秒                   | 要求単位 (RU) は、クエリまたはトランザクションのリソース消費を追跡するために使用される測定単位です。実行するクエリに加えて、リクエスト ユニットはバックグラウンド アクティビティによって消費される可能性があるため、QPS が 0 の場合、1 秒あたりのリクエスト ユニットはゼロにならない可能性があります。 |
| 使用済みストレージ サイズ   | 行ベースのstorage、列型storage | 行ストアのサイズと列ストアのサイズ。                                                                                                                                           |
| 1 秒あたりのクエリ      | すべて、{SQL タイプ}          | `SELECT` 、 `INSERT` 、 `UPDATE`などの SQL タイプ別に収集された、1 秒あたりに実行された SQL ステートメントの数。                                                                                 |
| 平均クエリ時間         | すべて、{SQL タイプ}          | クライアントからServerless Tierクラスターへのリクエストを受信してから、クラスターがリクエストを実行し、結果をクライアントに返すまでの時間。                                                                                |
| 失敗したクエリ         | 全て                     | 1 秒あたりの SQL ステートメント実行エラーの数。                                                                                                                                  |
| 1 秒あたりのトランザクション | 全て                     | 1 秒あたりに実行されたトランザクションの数。                                                                                                                                      |
| 平均トランザクション時間    | 全て                     | トランザクションの平均実行時間。                                                                                                                                             |
| 合計接続            | 全て                     | Serverless Tierクラスターへの接続数。                                                                                                                                   |

### データベースの状態 {#database-status}

次の表は、 **[データベース ステータス]**タブにあるデータベース レベルの主なメトリックを示しています。

| 指標名            | ラベル           | 説明                                                                                       |
| :------------- | :------------ | :--------------------------------------------------------------------------------------- |
| DB あたりの QPS    | すべて、{データベース名} | `SELECT` 、 `INSERT` 、 `UPDATE`などの SQL タイプ別に収集された、すべてのデータベースで 1 秒あたりに実行された SQL ステートメントの数。 |
| DB あたりの平均クエリ時間 | すべて、{データベース名} | クライアントからデータベースへのリクエストを受信してから、データベースがリクエストを実行し、結果をクライアントに返すまでの時間。                         |
| DB ごとの失敗したクエリ  | すべて、{データベース名} | 各データベースの 1 秒あたりの SQL ステートメント実行エラー数に基づくエラー タイプの統計。                                        |

## FAQ {#faq}

**1. このページの一部のペインが空白なのはなぜですか?**

ペインにメトリックが表示されない場合、考えられる理由は次のとおりです。

-   対応するクラスターのワークロードは、このメトリックをトリガーしません。たとえば、失敗したクエリがない場合、失敗したクエリ メトリックは常に空です。
-   クラスターのバージョンが低くなっています。これらのメトリックを表示するには、TiDB の最新バージョンにアップグレードする必要があります。

これらの理由がすべて除外されている場合は、トラブルシューティングのために[PingCAP サポート チーム](/tidb-cloud/tidb-cloud-support.md)に連絡できます。

**2. まれにメトリクスが不連続になるのはなぜですか?**

まれに、監視システムに大きな負荷がかかる場合など、メトリックが失われることがあります。

この問題が発生した場合は、 [PingCAP のサポート](/tidb-cloud/tidb-cloud-support.md)に連絡してトラブルシューティングを依頼できます。
